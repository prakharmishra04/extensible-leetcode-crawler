# Pre-commit hooks configuration
# See https://pre-commit.com for more information

repos:
  # General file checks
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v4.5.0
  hooks:
  - id: trailing-whitespace
    args: [--markdown-linebreak-ext=md]
  - id: end-of-file-fixer
  - id: check-yaml
  - id: check-json
  - id: check-added-large-files
    args: [--maxkb=1000]
  - id: check-merge-conflict
  - id: check-case-conflict
  - id: detect-private-key
  - id: mixed-line-ending
    args: [--fix=lf]

  # Python code formatting with Black
- repo: https://github.com/psf/black
  rev: 23.12.1
  hooks:
  - id: black
    language_version: python3.9
    args: [--line-length=100]

  # Python import sorting with isort
- repo: https://github.com/PyCQA/isort
  rev: 5.13.2
  hooks:
  - id: isort
    args: [--profile, black, --line-length, '100']

  # Python linting with flake8
- repo: https://github.com/PyCQA/flake8
  rev: 7.0.0
  hooks:
  - id: flake8
    args: [--max-line-length=100, --max-complexity=10, '--ignore=E203,E266,E501,W503', '--select=B,C,E,F,W,T4,B9']
    additional_dependencies: [flake8-bugbear, flake8-comprehensions, flake8-simplify]

  # Python type checking with mypy
- repo: https://github.com/pre-commit/mirrors-mypy
  rev: v1.8.0
  hooks:
  - id: mypy
    args: [--ignore-missing-imports, --no-strict-optional]
    additional_dependencies: [types-requests, types-PyYAML]
    exclude: ^tests/

  # Security checks with bandit
- repo: https://github.com/PyCQA/bandit
  rev: 1.7.6
  hooks:
  - id: bandit
    args: [-c, pyproject.toml]
    additional_dependencies: ['bandit[toml]']
    exclude: ^tests/

  # Docstring checks
- repo: https://github.com/PyCQA/pydocstyle
  rev: 6.3.0
  hooks:
  - id: pydocstyle
    args: [--convention=google]
    exclude: ^tests/

  # YAML formatting
- repo: https://github.com/macisamuele/language-formatters-pre-commit-hooks
  rev: v2.12.0
  hooks:
  - id: pretty-format-yaml
    args: [--autofix, --indent, '2']

  # Markdown formatting
- repo: https://github.com/executablebooks/mdformat
  rev: 0.7.17
  hooks:
  - id: mdformat
    additional_dependencies:
    - mdformat-gfm
    - mdformat-black

  # Commit message validation (Conventional Commits)
- repo: https://github.com/compilerla/conventional-pre-commit
  rev: v3.0.0
  hooks:
  - id: conventional-pre-commit
    stages: [commit-msg]
    args: []

  # Run tests before push
- repo: local
  hooks:
  - id: pytest-check
    name: pytest-check
    entry: pytest
    language: system
    pass_filenames: false
    always_run: true
    stages: [push]
    args: [-v, --tb=short, --maxfail=1]

# Configuration for specific hooks
default_language_version:
  python: python3.9

# Files to exclude from all hooks
exclude: |
  (?x)^(
      \.git/|
      \.hypothesis/|
      \.pytest_cache/|
      __pycache__/|
      htmlcov/|
      \.coverage|
      build/|
      dist/|
      \.eggs/|
      .*\.egg-info/
  )
